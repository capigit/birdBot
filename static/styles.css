/* ==== Design variables & reset ==== */
:root{
    --bg: #f4f7fb;
    --card: #ffffff;
    --muted: #6b7280;
    --accent: #0b84ff;
    --accent-600: #0666d1;
    --success: #17a673;
    --bot-bg: #e9f2ff;
    --user-bg: #e6fff0;
    --radius: 14px;
    --max-width: 920px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
    font-family: Inter,Segoe UI,Roboto, "Helvetica Neue", Arial, sans-serif;
    background: linear-gradient(180deg, var(--bg), #eef3f9 80%);
    margin:0;
    padding:32px 20px;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    -webkit-font-smoothing:antialiased;
}

/* Main container */
.app-shell{
    width:100%;
    max-width:var(--max-width);
    background:transparent;
}

h1{
    font-size:1.5rem;
    margin:0 0 18px 0;
    color:var(--accent-600);
    text-align:center;
    letter-spacing:0.2px;
}

/* Card / chat area */
#chatbox{
    background:var(--card);
    border-radius:var(--radius);
    padding:18px;
    min-height:420px;
    max-height:62vh;
    overflow:auto;
    box-shadow:0 10px 30px rgba(15,23,42,0.08);
    border: 1px solid rgba(15,23,42,0.04);
}

#chatbox > div{display:flex; gap:12px; align-items:flex-end; margin:14px 0}

#chatbox p{
    padding:12px 16px;
    margin:0;
    border-radius:12px;
    max-width:78%;
    line-height:1.45;
    box-shadow: 0 2px 8px rgba(15,23,42,0.03);
}

/* Alignements: bot à gauche, user à droite */
.bot{justify-content:flex-start}
.user{justify-content:flex-end}

.bot p{background:var(--bot-bg); color:#04497a; border-bottom-left-radius:6px}
.user p{background:var(--user-bg); color:#0b4f2b; border-bottom-right-radius:6px}

/* Image wrapper inside message */
.user-content{display:flex;flex-direction:column;align-items:flex-end}
.user-image{max-width:220px;height:auto;border-radius:10px;border:2px solid rgba(23,138,84,0.12);box-shadow:0 6px 18px rgba(15,23,42,0.06);margin-top:8px}

/* Timestamp or meta small text */
.meta{font-size:12px;color:var(--muted);margin-top:6px}

/* Input / controls card */
#input-container{
    margin-top:14px;
    display:flex;
    flex-direction:column;
    gap:12px;
    padding:14px;
    background:linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.45));
    border-radius:12px;
    border:1px solid rgba(15,23,42,0.03);
}

/* Forms */
#image-form{display:flex;gap:10px;align-items:center}
#image-file{flex:1}

#text-form{display:flex;gap:10px}
#text-input{
    flex:1;padding:12px 14px;border-radius:10px;border:1px solid rgba(15,23,42,0.06);
    background:linear-gradient(180deg,#fff,#fbfdff);
    outline:none;font-size:15px;color:#0f1724;transition:box-shadow .15s, border-color .15s
}
#text-input:focus{box-shadow:0 6px 20px rgba(11,132,255,0.08);border-color:var(--accent)}

/* Buttons */
button{
    padding:10px 14px;border-radius:10px;border:none;background:var(--accent);color:white;font-weight:600;cursor:pointer;transition:transform .08s ease, background .12s
}
button:hover{background:var(--accent-600);transform:translateY(-1px)}

/* File input styled fallback */
input[type=file]{padding:8px}

/* Welcome message */
.welcome-message{padding:10px 12px;background:transparent;border-radius:10px;border:1px dashed rgba(11,132,255,0.08);color:var(--muted)}

/* Small screens */
@media (max-width:640px){
    body{padding:18px}
    :root{--max-width:92vw}
    #chatbox{padding:12px;min-height:360px}
    #chatbox p{max-width:86%}
    .user-image{max-width:180px}
    h1{font-size:1.25rem}
}

/* Accessibility: prefers-reduced-motion */
@media (prefers-reduced-motion: reduce){
    button, #text-input{transition:none}
}

/* ===== Avatars, tails and micro-interactions ===== */
#chatbox > div{position:relative}

/* bot avatar on the left */
.bot::before{
    content:'';
    width:40px;height:40px;border-radius:50%;flex:0 0 40px;
    margin-right:10px;display:block;
    background-color:#fff;border:1px solid rgba(4,73,122,0.08);
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><circle cx='12' cy='8' r='3' fill='%2304497a'/><path d='M4 20c0-4 4-6 8-6s8 2 8 6' fill='%2304497a' opacity='0.12'/></svg>");
    background-repeat:no-repeat;background-position:center;background-size:60%;
    box-shadow:0 4px 12px rgba(4,73,122,0.06);
}

/* user avatar on the right */
.user::after{
    content:'';
    width:40px;height:40px;border-radius:50%;flex:0 0 40px;
    margin-left:10px;display:block;
    background-color:#fff;border:1px solid rgba(11,79,43,0.06);
    background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><circle cx='12' cy='8' r='3' fill='%230b4f2b'/><path d='M4 20c0-4 4-6 8-6s8 2 8 6' fill='%230b4f2b' opacity='0.08'/></svg>");
    background-repeat:no-repeat;background-position:center;background-size:60%;
    box-shadow:0 6px 14px rgba(11,79,43,0.04);
}

/* bubble tails */
#chatbox p{position:relative}
#chatbox p::after{content:'';position:absolute;bottom:6px;width:14px;height:14px;transform:rotate(45deg)}
.bot p::after{left:-6px;background:var(--bot-bg);box-shadow:0 2px 6px rgba(15,23,42,0.03)}
.user p::after{right:-6px;background:var(--user-bg);box-shadow:0 2px 6px rgba(15,23,42,0.03)}

/* subtle appear animation for new messages */
@keyframes msgIn{from{opacity:0;transform:translateY(6px) scale(.998)}to{opacity:1;transform:none}}
#chatbox > div{animation:msgIn .18s ease both}

/* reduce avatar size on very small screens */
@media (max-width:420px){
    .bot::before,.user::after{width:34px;height:34px}
}

/* ===== Dark theme (automatic via OS preference) ===== */
@media (prefers-color-scheme: dark){
    :root{ --bg: #0b1020; --card: #0f1724; --muted: #9aa6b2; --accent: #58a6ff; --accent-600: #2f8ee6; --bot-bg: #07203a; --user-bg: #083022 }
    body{background:linear-gradient(180deg, #071026, #071025 80%)}
    h1{color:var(--accent-600)}
    #chatbox{background:var(--card);box-shadow:0 10px 30px rgba(2,6,23,0.7);border:1px solid rgba(255,255,255,0.03)}
    #chatbox p{box-shadow: 0 2px 12px rgba(2,6,23,0.45); color:#e6eef6}
    .bot p{background:linear-gradient(180deg, rgba(6,30,54,0.6), rgba(6,30,54,0.48)); color:#cfe8ff}
    .user p{background:linear-gradient(180deg, rgba(6,40,34,0.6), rgba(6,40,34,0.48)); color:#dff7e8}
    #input-container{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(255,255,255,0.02)}
    #text-input{background:linear-gradient(180deg,#0c131a,#071018);border:1px solid rgba(255,255,255,0.04);color:#e6eef6}
    button{background:var(--accent)}
    .welcome-message{border:1px dashed rgba(88,166,255,0.12); color:var(--muted)}
    /* avatar tint adjustments for dark */
    .bot::before{background-color:#071826;border-color:rgba(88,166,255,0.06)}
    .user::after{background-color:#071a12;border-color:rgba(23,138,84,0.05)}
}
